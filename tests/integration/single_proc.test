#!/usr/bin/env tclsh

package require tcltest
package require turtles::test::integration::mt
package require turtles::test::integration::ev
namespace import ::tcltest::*

set noop_staged_test {
	proc ::noop {} { return }
	noop
	after 100
	update
	test_caller_callee_count stage1 {} {::noop} 1
	return 1
}

set noop_direct_test {
	proc ::noop {} { return }
	noop
	test_caller_callee_count stage0 {} {::noop} 1
	return 1

}

namespace import ::turtles::test::integration::mt::*

with_turtles "Single proc trace (mt)" staged 50 [subst {$noop_staged_test}]
with_turtles "Single proc trace (mt)" direct 50 [subst {$noop_direct_test}]

namespace forget ::turtles::test::integration::mt::*
namespace import ::turtles::test::integration::ev::*

with_turtles "Single proc trace (ev)" staged 50 [subst {$noop_staged_test}]
with_turtles "Single proc trace (ev)" direct 50 [subst {$noop_direct_test}]


cleanupTests
